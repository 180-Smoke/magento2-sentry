<?php
// phpcs:disable Magento2.Templates.ThisInTemplate.FoundThis
/** @var \JustBetter\Sentry\Block\SentryScript $block */

if (! $block->canUseScriptTag($block->getNameInLayout())) {
    return;
}
?>

<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise" crossorigin></script>
<script src="https://browser.sentry-cdn.com/4.5.3/bundle.min.js" crossorigin></script>
<script>Sentry.init({ dsn: '<?= $block->escapeUrl(trim($block->getDSN())) ?>' });</script>

<?php if ($block->useLogRocket()) : ?>
    <script src="https://cdn.lr-ingest.io/LogRocket.min.js" crossorigin="anonymous"></script>
    <script>window.LogRocket && window.LogRocket.init('<?= trim($block->getLogrocketKey()) ?>');</script>
    <script>
        LogRocket.getSessionURL(sessionURL => {
            Sentry.configureScope(scope => {
                scope.setExtra("sessionURL", sessionURL);
            });
        });
        <?php if ($block->useLogRocketIdentify()) : ?>
        LogRocket.identify('<?= $block->getCustomerId() ?>', {
            name: '<?= $block->getCustomerName() ?>',
            email: '<?= $block->getCustomerEmail() ?>'
        });
        <?php endif; ?>
    </script>
<?php endif; ?>
